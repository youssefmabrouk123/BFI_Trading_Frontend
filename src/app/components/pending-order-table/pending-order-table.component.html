<div class="table-wrapper">
  <div class="filter-panel sticky left-0 z-50">
    <div class="filter-header">
      <div class="filter-header-content">
        <div class="filter-title-group">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
          </svg>
          <h3 class="filter-title">Pending Orders</h3>
          <div class="table-controls">
            <button class="refresh-btn" (click)="refreshOrders()" [class.loading]="isRefreshing">
              <i class="fa fa-sync refresh-icon" [class.spinning]="isRefreshing"></i>
            </button>
          </div>
        </div>
        <div class="filter-controls">
          <div class="search-group">
            <input type="text" 
                   class="search-input" 
                   placeholder="Search orders..." 
                   [(ngModel)]="searchQuery" 
                   (ngModelChange)="filterOrders()">
            <button class="search-btn">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <table class="market-table">
    <thead>
      <tr>
        <th class="instrument-col sticky left-0 z-20">ID</th>
        <th>Paire de Devises</th>
        <th>Montant</th>
        <th>Prix Cible</th>
        <th>Type d'Ordre</th>
        <th>Type de Déclencheur</th>
        <th>Action</th>
        <th>Statut</th>
        <th>Date de Création</th>
        <th>Date d'Exécution</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody *ngIf="!isLoading && filteredOrders.length > 0">
      <tr *ngFor="let order of filteredOrders; trackBy: trackById">
        <td class="instrument-col sticky left-0 z-10">{{ order.id }}</td>
        <td>
          <div class="instrument-cell">
            <span class="type-badge fx">{{ order.baseCurrencyIdentifier }}/{{ order.quoteCurrencyIdentifier }}</span>
          </div>
        </td>
        <td>{{ order.amount }}</td>
        <td>{{ order.targetPrice }}</td>
        <td>
          <span [class]="order.orderType === 'BUY' ? 'text-green-500' : 'text-red-500'">
            {{ order.orderType }}
          </span>
        </td>
        <td>{{ order.triggerType }}</td>
        <td>{{ order.actionOnTrigger }}</td>
        <td>
          <span [ngClass]="{
            'type-badge bg-green-900/50 text-green-500': order.status === 'EXECUTED',
            'type-badge bg-yellow-900/50 text-yellow-500': order.status === 'PENDING',
            'type-badge bg-red-900/50 text-red-500': order.status === 'CANCELLED'
          }">
            {{ order.status }}
          </span>
        </td>
        <td>{{ order.createdAt | date:'medium' }}</td>
        <td>{{ order.executedAt ? (order.executedAt | date:'medium') : '-' }}</td>
        <td>
          <button 
            class="signal-btn" 
            (click)="cancelOrder(order.id!)" 
            [disabled]="order.status !== 'PENDING'">
            Annuler
          </button>
        </td>
      </tr>
    </tbody>
    <tbody *ngIf="!isLoading && filteredOrders.length === 0">
      <tr>
        <td colspan="11" class="p-4 text-center text-gray-500">No pending orders available.</td>
      </tr>
    </tbody>
    <tbody *ngIf="isLoading">
      <tr *ngFor="let skeleton of skeletonArray">
        <td class="skeleton-cell" colspan="11">
          <div class="skeleton skeleton-text"></div>
        </td>
      </tr>
    </tbody>
  </table>
</div>